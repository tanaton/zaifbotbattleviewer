!function(t){function s(s){for(var a,h,d=s[0],n=s[1],o=s[2],u=0,p=[];u<d.length;u++)h=d[u],Object.prototype.hasOwnProperty.call(i,h)&&i[h]&&p.push(i[h][0]),i[h]=0;for(a in n)Object.prototype.hasOwnProperty.call(n,a)&&(t[a]=n[a]);for(c&&c(s);p.length;)p.shift()();return r.push.apply(r,o||[]),e()}function e(){for(var t,s=0;s<r.length;s++){for(var e=r[s],a=!0,d=1;d<e.length;d++){var n=e[d];0!==i[n]&&(a=!1)}a&&(r.splice(s--,1),t=h(h.s=e[0]))}return t}var a={},i={2:0},r=[];function h(s){if(a[s])return a[s].exports;var e=a[s]={i:s,l:!1,exports:{}};return t[s].call(e.exports,e,e.exports,h),e.l=!0,e.exports}h.m=t,h.c=a,h.d=function(t,s,e){h.o(t,s)||Object.defineProperty(t,s,{enumerable:!0,get:e})},h.r=function(t){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},h.t=function(t,s){if(1&s&&(t=h(t)),8&s)return t;if(4&s&&"object"==typeof t&&t&&t.__esModule)return t;var e=Object.create(null);if(h.r(e),Object.defineProperty(e,"default",{enumerable:!0,value:t}),2&s&&"string"!=typeof t)for(var a in t)h.d(e,a,function(s){return t[s]}.bind(null,a));return e},h.n=function(t){var s=t&&t.__esModule?function(){return t.default}:function(){return t};return h.d(s,"a",s),s},h.o=function(t,s){return Object.prototype.hasOwnProperty.call(t,s)},h.p="";var d=window.webpackJsonp=window.webpackJsonp||[],n=d.push.bind(d);d.push=s,d=d.slice();for(var o=0;o<d.length;o++)s(d[o]);var c=n;r.push([62,0]),e()}({62:function(t,s,e){"use strict";e.r(s);var a=e(0),i=e(7);function r(t){switch(t){case"btc_jpy":case"xem_jpy":case"mona_jpy":case"bch_jpy":case"eth_jpy":return!0}return!1}function h(t){switch(t){case"ask":case"bid":return!0}return!1}function d(t){switch(t){case"Asks":case"Bids":case"LastPrice":return!0}return!1}const n=["btc_jpy","xem_jpy","mona_jpy","bch_jpy","eth_jpy"],o=a.l("%H:%M:%S"),c=a.f(".1f"),u=t=>parseInt(t,10);const p=new class{constructor(){this.diff=0,this.diffmax=0,this.tmpdate=new Date}set(t){let s=Date.parse(t);if(Number.isNaN(s)){const e=t.split(" ",2).map((t,s)=>{var e;if(0===s)return t.split("-",3);const a=null!==(e=t.indexOf("."))&&void 0!==e?e:-1;return a<0?t.split(":",3).concat(["0"]):t.slice(0,a).split(":",3).concat([t.slice(a+1)])}).reduce((t,s)=>t.concat(s)).map(u);e.length>=7?(this.tmpdate.setFullYear(e[0],e[1]-1,e[2]),this.tmpdate.setHours(e[3],e[4],e[5],e[6]/1e3|0),s=this.tmpdate.getTime()):s=Date.now()}const e=s-Date.now();(0===this.diffmax||e<this.diffmax)&&(this.diffmax=e),this.diff=e}reset(){this.diff=0,this.diffmax=0}getDate(){return new Date(Date.now()+this.diffmax)}getTime(){return this.tmpdate.setTime(Date.now()+this.diffmax),this.tmpdate.getTime()}getDiff(){return this.diff}};class _{constructor(t){this.focus_margin={top:10,right:10,bottom:20,left:55},this.focus_width=0,this.focus_height=0,this.summary_margin={top:10,right:10,bottom:20,left:55},this.summary_width=0,this.summary_height=0,this.depth_margin={top:10,right:10,bottom:20,left:55},this.depth_width=0,this.depth_height=0,this.tid=0,this.rid=0,this.focus_data=[],this.focus_data_legend=[],this.summary_data=[],this.context_data=[],this.depth_data=[{name:"Asks",values:[]},{name:"Bids",values:[]}],this.datamap={},this.draw_focus=!1,this.draw_summary=!1,this.draw_summary_old_date=p.getTime(),this.draw_depth=!1,this.focus_domain_yaxis_update=!1,this.focus_xaxis_sec=120,this.ydtmp=[{date:t.Date,data:1e7},{date:t.Date,data:-1e7}],this.focus_x=a.j().domain([0,0]),this.focus_y=a.h().domain([1e7,-1e7]),this.focus_xAxis=a.b(this.focus_x).tickFormat(o).tickPadding(7).ticks(5),this.focus_yAxis=a.c(this.focus_y).tickPadding(7).ticks(5),this.focus_line=a.g().curve(a.e).x(t=>this.focus_x(t.date)).y(t=>this.focus_y(t.data)),this.focus_path_d=t=>this.focus_line(t.values),this.summary_x=a.j().domain(this.focus_x.domain()),this.summary_y=a.h().domain(this.focus_y.domain()),this.summary_xAxis=a.b(this.summary_x).tickFormat(o).tickPadding(7).ticks(5),this.summary_yAxis=a.c(this.summary_y).tickPadding(7),this.summary_line=a.g().curve(a.e).x(t=>this.summary_x(t.date)).y(t=>this.summary_y(t.data)),this.summary_path_d=t=>this.summary_line(t.values),this.depth_x=a.h().domain([0,0]),this.depth_y=a.h().domain([1e7,-1e7]),this.depth_xAxis=a.b(this.depth_x).tickPadding(7).ticks(5),this.depth_yAxis=a.c(this.depth_y).tickFormat(t=>{let s;return s=t>=1e6?c(t/1e6)+"M":(t/1e3|0)+"k",s}).tickPadding(7).ticks(2),this.depth_line=a.g().curve(a.e).x(t=>this.depth_x(t.price)).y(t=>this.depth_y(t.depth)),this.depth_path_d=t=>this.depth_line(t.values),this.depth_line_area=a.a().curve(a.e).x(t=>this.depth_x(t.price)).y0(()=>this.depth_y(0)).y1(t=>this.depth_y(t.depth)),this.depth_area_d=t=>this.depth_line_area(t.values),this.summary_color=a.i().range(["#b94047","#47ba41","#4147ba","#bab441","#41bab4","#b441ba"]),this.summary_path_stroke=t=>this.summary_color(t.name),this.focus_legend_update=t=>`${t.name} ${t.last_price.toLocaleString()}`,this.init(t),this.dom=a.k("#svgarea").append("div").attr("class","row"),this.svg=a.k("#svgarea").append("svg"),this.focus=this.svg.selectAll(".focus").data(this.focus_data).enter().append("g").attr("class","focus"),this.focus_legend=this.dom.selectAll(".focus-legend").data(this.focus_data_legend).enter().append("div").attr("class","col-12 col-sm-6 col-md-4 col-xl-3 focus-legend"),this.summary=this.svg.selectAll(".summary").data(this.summary_data).enter().append("g").attr("class","summary"),this.depth=this.svg.selectAll(".depth").data(this.depth_data).enter().append("g").attr("class","depth"),this.focus_path_g=this.focus.append("path").attr("class","line focus-path").style("stroke",this.summary_path_stroke),this.focus_xAxis_g=this.svg.append("g").attr("class","x axis focus-x"),this.focus_yAxis_g=this.svg.append("g").attr("class","y axis focus-y"),this.focus_legend.append("span").html("&#x25A0;").style("color",this.summary_path_stroke).attr("class","focus-legend-rect"),this.focus_legend_g=this.focus_legend.append("span").text(this.focus_legend_update).attr("class","focus-legend-text"),this.summary_path_g=this.summary.append("path").attr("class","line summary-path").style("stroke",this.summary_path_stroke),this.summary_xAxis_g=this.svg.append("g").attr("class","x axis summary-x"),this.summary_yAxis_g=this.svg.append("g").attr("class","y axis summary-y"),this.depth_path_g=this.depth.append("path").attr("class","line depth-path").style("stroke",this.summary_path_stroke),this.depth_area_g=this.depth.append("path").attr("class","depth-area-path").attr("opacity",.3).style("fill",this.summary_path_stroke),this.depth_xAxis_g=this.svg.append("g").attr("class","x axis depth-x"),this.depth_yAxis_g=this.svg.append("g").attr("class","y axis depth-y"),this.resize()}init(t){this.summary_color.domain([]),this.addsig(t),this.startTimer(10)}startTimer(t){if(t<=0)return;const s={Name:"",Date:0,Signals:{Asks:{Data:0},Bids:{Data:0},LastPrice:{Data:0}}};this.tid=window.setInterval(()=>{let t=!1;s.Date=p.getTime();for(const e of this.context_data){const a=e.values;a.length>0&&(s.Signals[e.name]={Data:a[a.length-1].data},t=!0)}t&&this.addContext(s),this.draw()},1e3/t)}stopTimer(){this.tid&&(window.clearInterval(this.tid),this.tid=0)}restartTimer(t){this.stopTimer(),this.startTimer(t)}resize(){var t;const s=document.getElementById("svgarea"),e=null!==(t=null==s?void 0:s.offsetWidth)&&void 0!==t?t:850;this.focus_width=e-this.focus_margin.left-this.focus_margin.right,this.focus_height=Math.min(this.focus_width,500),this.summary_margin.top=this.focus_height+this.focus_margin.top+this.focus_margin.bottom+10,this.summary_width=e-this.summary_margin.left-this.summary_margin.right,this.summary_height=100,this.depth_margin.top=this.summary_height+this.summary_margin.top+this.summary_margin.bottom+10,this.depth_width=e-this.depth_margin.left-this.depth_margin.right,this.depth_height=130,this.focus_x.range([0,this.focus_width]),this.focus_y.range([this.focus_height,0]),this.focus_xAxis.tickSizeInner(-this.focus_height),this.focus_yAxis.tickSizeInner(-this.focus_width),this.summary_x.range([0,this.summary_width]),this.summary_y.range([this.summary_height,0]),this.summary_xAxis.tickSizeInner(-this.summary_height),this.summary_yAxis.tickSizeInner(-this.summary_width),this.depth_x.range([0,this.depth_width]),this.depth_y.range([this.depth_height,0]),this.depth_xAxis.tickSizeOuter(-this.depth_height).tickSizeInner(-this.depth_height),this.depth_yAxis.tickSizeOuter(-this.depth_width).tickSizeInner(-this.depth_width),this.svg.attr("width",this.focus_width+this.focus_margin.left+this.focus_margin.right+10).attr("height",this.depth_height+this.depth_margin.top+this.depth_margin.bottom+10),this.focus.attr("transform",`translate(${this.focus_margin.left},${this.focus_margin.top})`),this.summary.attr("transform",`translate(${this.summary_margin.left},${this.summary_margin.top})`),this.depth.attr("transform",`translate(${this.depth_margin.left},${this.depth_margin.top})`),this.focus_xAxis_g.attr("transform",`translate(${this.focus_margin.left},${this.focus_height+this.focus_margin.top})`),this.focus_yAxis_g.attr("transform",`translate(${this.focus_margin.left},${this.focus_margin.top})`),this.summary_xAxis_g.attr("transform",`translate(${this.summary_margin.left},${this.summary_height+this.summary_margin.top})`),this.summary_yAxis_g.attr("transform",`translate(${this.summary_margin.left},${this.summary_margin.top})`),this.depth_xAxis_g.attr("transform",`translate(${this.depth_margin.left},${this.depth_height+this.depth_margin.top})`),this.depth_yAxis_g.attr("transform",`translate(${this.depth_margin.left},${this.depth_margin.top})`)}dispose(){this.stopTimer(),this.rid&&(window.cancelAnimationFrame(this.rid),this.rid=0);const t=document.getElementById("svgarea");t&&(t.innerHTML="")}addsig(t){var s;const e=t.Date,a=t.Signals,i=[];let r=!1;for(const t in a)if(d(t)&&a.hasOwnProperty(t)&&void 0===this.datamap[t]){const h={date:e,data:null!==(s=a[t].Data)&&void 0!==s?s:0};i.push(t),this.context_data.push({name:t,values:[h]}),this.focus_data.push({name:t,values:[h]}),this.summary_data.push({name:t,values:[h]}),this.focus_data_legend.push({name:t,last_price:0}),this.datamap[t]=!0,r=!0}return this.summary_color.domain(i),r}static appendData(t,s,e){const a=t.values,i=a[a.length-1];if(void 0!==i)if(e){const t=a[a.length-2];(null==t?void 0:t.data)===i.data&&i.data===s.data?a[a.length-1]=s:a.push(s)}else i.data!==s.data&&a.push(s);else a.push(s)}addContext(t,s){const e=t.Date,a=e-1e3*this.focus_xaxis_sec,i=this.focus_data.length,r=t.Signals;if(r){e-3e4>this.draw_summary_old_date&&(this.draw_summary=!0);for(let t=0;t<i;t++){const i=this.focus_data[t],h=this.summary_data[t],d=this.context_data[t],n=i.name;if(!r[n])continue;const o=r[n].Data,c={date:e,data:o};for(_.appendData(i,c,!0),this.draw_focus=!0,_.appendData(d,c),this.focus_data_legend[t].last_price=o;i.values.length>1e3;)i.values.shift();for(;i.values.length>2&&i.values[0].date<a&&i.values[1].date<a;)i.values.shift();for(i.values[0].date<a&&(i.values[0].date=a);d.values.length>16e3;)d.values.shift();(this.draw_summary||s)&&(_.LTTB(h.values,d.values,200),this.draw_summary_old_date=e)}}}addDepth(t){var s;const e=null!==(s=t.Depths)&&void 0!==s?s:{};this.addDepthSub(e.Asks,this.depth_data[0]),this.addDepthSub(e.Bids,this.depth_data[1])}addDepthSub(t,s){if(!t)return;const e=s.values;let a=0,i=0;void 0===e[i]?e[i]={price:t[0][0],depth:0}:(e[i].price=t[0][0],e[i].depth=0),++i;for(const s of t)a+=s[0]*s[1],void 0===e[i]?e[i]={price:s[0],depth:a}:(e[i].price=s[0],e[i].depth=a),++i;this.draw_depth=!0}static contextMinFunc(t,s){return Math.min(t,s.data)}static contextMaxFunc(t,s){return Math.max(t,s.data)}updateFocusDomain(t=!1){const s=p.getTime(),e=s-1e3*this.focus_xaxis_sec,a=[e,s],i=this.ydtmp;if(!1===this.focus_domain_yaxis_update&&!1===t)for(const t of this.focus_data){const e=t.values.length-1;if(e>=0){const a=t.values[e].data;i[0].data>a?(i[0].date=s,i[0].data=a):i[1].data<a&&(i[1].date=s,i[1].data=a)}}(i[0].date<e||this.focus_domain_yaxis_update||t)&&(i[0].data=this.focus_data.reduce((t,s)=>{const e=s.values.reduce(_.contextMinFunc,1e7);return Math.min(t,e)},1e7)),(i[1].date<e||this.focus_domain_yaxis_update||t)&&(i[1].data=this.focus_data.reduce((t,s)=>{const e=s.values.reduce(_.contextMaxFunc,-1e7);return Math.max(t,e)},-1e7)),this.focus_domain_yaxis_update=!1,this.focus_x.domain(a),this.focus_y.domain([i[0].data,i[1].data]).nice()}updateSummaryDomain(){const t=p.getTime(),s=[t,t],e=this.summary_y.domain();for(const t of this.summary_data)e[0]=t.values.reduce(_.contextMinFunc,1e7),e[1]=t.values.reduce(_.contextMaxFunc,-1e7),s[0]>t.values[0].date&&(s[0]=t.values[0].date);this.summary_x.domain(s),this.summary_y.domain(e).nice()}static depthMaxFunc(t,s){return Math.max(t,s.depth)}updateDepthDomain(){const t=this.depth_x.domain(),s=this.depth_y.domain();t[0]=this.depth_data[1].values.reduce((t,s)=>Math.min(t,s.price),1e7),t[1]=this.depth_data[0].values.reduce((t,s)=>Math.max(t,s.price),-1e7),s[0]=0,s[1]=Math.max(this.depth_data[0].values.reduce(_.depthMaxFunc,-1e7),this.depth_data[1].values.reduce(_.depthMaxFunc,-1e7)),this.depth_x.domain(t),this.depth_y.domain(s).nice()}sortContext(){const t=this.focus_data.length;for(let s=0;s<t;s++)this.focus_data[s].values.sort(_.compChartPathData),this.context_data[s].values.sort(_.compChartPathData),this.summary_data[s].values.sort(_.compChartPathData)}static compChartPathData(t,s){return t.date-s.date}setFocusXAxis(t=120){const s=p.getTime()-1e3*t,e=this.focus_data.length,a=t=>t.date>=s;for(let t=0;t<e;t++){const s=this.context_data[t].values,e=s.findIndex(a);e>=1&&(this.focus_data[t].values=s.slice(e-1))}this.focus_domain_yaxis_update=!0,this.focus_xaxis_sec=t}draw(t=!1){t&&(this.draw_focus=!0,this.draw_summary=!0,this.draw_depth=!0),0===this.rid&&(this.rid=window.requestAnimationFrame(()=>{this.drawsub(),this.rid=0}))}drawsub(){this.draw_focus&&(this.draw_focus=!1,this.updateFocusDomain(),this.focus_path_g.attr("d",this.focus_path_d),this.focus_legend_g.text(this.focus_legend_update),this.focus_xAxis_g.call(this.focus_xAxis),this.focus_yAxis_g.call(this.focus_yAxis)),this.draw_summary&&(this.draw_summary=!1,this.updateSummaryDomain(),this.summary_path_g.attr("d",this.summary_path_d),this.summary_xAxis_g.call(this.summary_xAxis),this.summary_yAxis.tickValues(this.summary_y.domain()),this.summary_yAxis_g.call(this.summary_yAxis)),this.draw_depth&&(this.draw_depth=!1,this.updateDepthDomain(),this.depth_path_g.attr("d",this.depth_path_d),this.depth_area_g.attr("d",this.depth_area_d),this.depth_xAxis_g.call(this.depth_xAxis),this.depth_yAxis_g.call(this.depth_yAxis))}static LTTB(t,s,e=200){let a=0;const i=s.length;if(e>=i||e<3){for(a=0;a<i;++a)t[a]=s[a];return void(t.length>a&&(t.length=a))}const r=Math.abs,h=Math.floor;t[a++]=s[0];const d=(i-2)/(e-2);let n=1,o=h(d)+1,c=0;for(let u=0;u<e-2;u++){const e=h((u+2)*d)+1;let p=o,_=e;_>=i&&(_=i);const m=_-p;let l=0,f=0;for(;p<_;p++)l+=s[p].date,f+=s[p].data;l/=m,f/=m;const g=s[c].date,y=s[c].data;let x=-1e7;for(;n<o;n++){const t=s[n],e=r((g-l)*(t.data-y)-(g-t.date)*(f-y));e>x&&(x=e,c=n)}t[a++]=s[c],o=e}t[a++]=s[i-1],t.length>a&&(t.length=a)}}class m{constructor(t="#btc_jpy"){this.graph=void 0,this.currency_pair=m.getCurrencyPair("#btc_jpy"),this.resize_timeid=0,this.tmpdate=new Date,this.init(t),window.addEventListener("resize",()=>this.changesize(),!1),window.addEventListener("orientationchange",()=>this.changesize(),!1),window.addEventListener("hashchange",()=>{l.focus.xaxis.selected=120,l.focus.fps.selected=10,this.clear(),this.init(location.hash)},!1)}init(t="#btc_jpy"){p.reset(),this.currency_pair=m.getCurrencyPair(t),this.loadHistory(),this.ws=new WebSocket(this.getWebsocketURL()),this.ws.addEventListener("open",()=>{console.log("接続しました。")}),this.ws.addEventListener("error",t=>{console.error("WebSocket Error "+t)}),this.ws.addEventListener("close",()=>{console.log("切断しました。")}),this.ws.addEventListener("message",t=>{const s=JSON.parse(t.data);var e;(e=s)instanceof Object!=0&&!1!==r(e.currency_pair)&&e.timestamp&&e.asks instanceof Array!=0&&!1!==e.asks.every(t=>2===t.length)&&e.bids instanceof Array!=0&&!1!==e.bids.every(t=>2===t.length)&&e.trades instanceof Array!=0&&!1!==e.trades.every(t=>h(t.trade_type))&&e.last_price instanceof Object!=0&&!1!==h(e.last_price.action)&&this.update(s)})}clear(){var t,s;this.resize_timeid>0&&(window.clearTimeout(this.resize_timeid),this.resize_timeid=0),null===(t=this.ws)||void 0===t||t.close(),this.ws=void 0,null===(s=this.graph)||void 0===s||s.dispose(),this.graph=void 0}resize(){var t,s;null===(t=this.graph)||void 0===t||t.resize(),null===(s=this.graph)||void 0===s||s.draw(!0)}changesize(){this.resize_timeid>0&&(window.clearTimeout(this.resize_timeid),this.resize_timeid=0),this.resize_timeid=window.setTimeout(()=>{this.resize(),this.resize_timeid=0},128)}static getCurrencyPair(t="#btc_jpy"){var s;const e=t.slice(1);return null!==(s=n.find(t=>t===e))&&void 0!==s?s:n[0]}getWebsocketURL(){return"wss://ws.zaif.jp/stream?currency_pair="+this.currency_pair}static getDirection(t){return"ask"===t?"▼":"▲"}update(t){p.set(t.timestamp);const s={Name:t.currency_pair,Date:p.getTime(),Signals:{Asks:{Data:t.asks[0][0]},Bids:{Data:t.bids[0][0]},LastPrice:{Data:t.last_price.price}},Depths:{Asks:t.asks,Bids:t.bids}};void 0===this.graph&&this.createGraph(s),this.addData(s),this.updateView(t)}updateView(t){for(const t in l.currencys)r(t)&&l.currencys.hasOwnProperty(t)&&(l.currencys[t].active="");l.currencys[this.currency_pair].active="active";{const t=this.currency_pair.split("_");l.currency_pair.first=t[0],l.currency_pair.second=t[1]}l.last_trade.price=t.last_price.price.toLocaleString(),l.last_trade.action=m.getDirection(t.last_price.action),l.last_trade.type=t.last_price.action,document.title=l.last_trade.action+" "+l.last_trade.price+` (${l.currency_pair.first}/${l.currency_pair.second}) 取引の様子 - zaifの取引情報を表示するやつ`;for(let s=t.trades.length-1;s>=0;--s){const e=t.trades[s];let a="";if(s===t.trades.length-1)a=m.getDirection(e.trade_type);else{const t=l.trades[s+1];(t.trade_type===e.trade_type&&t.price_orig!==e.price||t.trade_type!==e.trade_type)&&(a=m.getDirection(e.trade_type))}this.tmpdate.setTime(1e3*e.date),void 0===l.trades[s]?l.trades[s]={tid:e.tid,trade_type:e.trade_type,direction:a,price_orig:e.price,price:e.price.toLocaleString(),amount:e.amount,date:o(this.tmpdate)}:(l.trades[s].tid=e.tid,l.trades[s].trade_type=e.trade_type,l.trades[s].direction=a,l.trades[s].price_orig=e.price,l.trades[s].price=e.price.toLocaleString(),l.trades[s].amount=e.amount,l.trades[s].date=o(this.tmpdate))}this.analyzeBoard(l.bids,t.bids),this.analyzeBoard(l.asks,t.asks),l.date_diff=p.getDiff()}analyzeBoard(t,s){let e=0,a=0;for(const i of s){e+=i[0]*i[1];const s=i[0].toLocaleString(),r=(0|e).toLocaleString();void 0===t[a]?t[a]={price:s,amount:i[1],depth:r}:(t[a].price=s,t[a].amount=i[1],t[a].depth=r),++a}}setGraphFocusXAxis(t){var s;null===(s=this.graph)||void 0===s||s.setFocusXAxis(t)}setGraphFocusFPS(t){var s;null===(s=this.graph)||void 0===s||s.restartTimer(t)}createGraph(t){this.graph=new _(t)}addData(t){void 0!==this.graph&&(this.graph.addContext(t),this.graph.addDepth(t))}loadHistory(){const t="/api/zaif/1/oldstream/"+this.currency_pair,s=new AbortController,e=s.signal;Promise.race([fetch(t,{signal:e}),new Promise((t,e)=>{setTimeout(()=>{s.abort(),e(new Error("timeout"))},1e4)})]).then(t=>{if(t.ok)return t.json();throw new Error(t.statusText)}).then(t=>{console.log("履歴の取得に成功"),this.addDataHistory(t)}).catch(t=>{console.error(t)})}addDataHistory(t){let s=void 0,e=void 0,a=void 0;const i=t.length-1,r={Name:this.currency_pair,Date:0,Signals:{Asks:{Data:0},Bids:{Data:0},LastPrice:{Data:0}}};for(let h=0;h<=i;++h){const d=t[h];void 0!==d.ask&&(s=d.ask),void 0!==d.bid&&(e=d.bid),void 0!==d.trade&&(a=d.trade),void 0!==s&&void 0!==e&&void 0!==a&&(r.Date=1e3*d.ts,r.Signals.Asks.Data=s[0],r.Signals.Bids.Data=e[0],r.Signals.LastPrice.Data=a.price,void 0===this.graph&&this.createGraph(r),this.graph&&this.graph.addContext(r,h===i))}void 0!==s&&void 0!==e&&void 0!==a&&this.graph&&(this.graph.sortContext(),this.graph.updateFocusDomain(!0),this.graph.updateSummaryDomain(),this.graph.draw(!0))}}const l={last_trade:{price:"0",action:"▲",type:"bid"},bids:[],asks:[],trades:[],focus:{xaxis:{selected:120,options:[{text:"1分",value:60},{text:"2分",value:120},{text:"5分",value:300},{text:"10分",value:600},{text:"30分",value:1800}]},fps:{selected:10,options:[{text:"無し",value:0},{text:"1fps",value:1},{text:"5fps",value:5},{text:"10fps",value:10},{text:"30fps",value:30},{text:"60fps",value:60}]}},currency_pair:{first:"btc",second:"jpy"},date_diff:0,currencys:{btc_jpy:{name:"btc/jpy",hash:"/zaif/#btc_jpy",active:""},xem_jpy:{name:"xem/jpy",hash:"/zaif/#xem_jpy",active:""},mona_jpy:{name:"mona/jpy",hash:"/zaif/#mona_jpy",active:""},bch_jpy:{name:"bch/jpy",hash:"/zaif/#bch_jpy",active:""},eth_jpy:{name:"eth/jpy",hash:"/zaif/#eth_jpy",active:""}}};new i.a({el:"#container",data:l,computed:{date_diff_print:()=>(l.date_diff/1e3).toString()},watch:{"focus.xaxis.selected":t=>{f.setGraphFocusXAxis(t)},"focus.fps.selected":t=>{f.setGraphFocusFPS(t)}}});let f=new m(location.hash)}});
//# sourceMappingURL=realtimegraph.js.map